services:

# Backend API Service

- type: web
  name: ibc-play-api
  env: python
  region: oregon
  plan: free
  buildCommand: |
  pip install –upgrade pip
  pip install -r requirements.txt
  python db_init.py
  startCommand: uvicorn main:app –host 0.0.0.0 –port $PORT
  envVars:
  - key: PYTHON_VERSION
    value: 3.11.0
  - key: SECRET_KEY
    generateValue: true
  - key: JWT_ALGORITHM
    value: HS256
  - key: ACCESS_TOKEN_EXPIRE_MINUTES
    value: 43200
  - key: COINGECKO_API_URL
    value: https://api.coingecko.com/api/v3
  - key: PRICE_CACHE_TTL
    value: 60
  - key: SUPPORTED_CRYPTOS
    value: BTC,ETH,SOL,BNB
  - key: MIN_BET_AMOUNT
    value: 1.0
  - key: MAX_BET_AMOUNT
    value: 10000.0
  - key: INITIAL_BALANCE
    value: 100.0
  - key: HOUSE_EDGE_DICE
    value: 2.0
  - key: HOUSE_EDGE_SLOTS
    value: 5.0
  - key: HOUSE_EDGE_ROULETTE
    value: 2.7
  - key: HOUSE_EDGE_BLACKJACK
    value: 1.5
  - key: HOUSE_EDGE_CRASH
    value: 3.0
  - key: HOUSE_EDGE_COINFLIP
    value: 2.5
    healthCheckPath: /health
    autoDeploy: true

# Static Frontend Service (Optional)

- type: web
  name: ibc-play-frontend
  env: static
  region: oregon
  plan: free
  buildCommand: echo “No build required for static site”
  staticPublishPath: ./frontend
  routes:
  - type: rewrite
    source: /*
    destination: /index.html
    headers:
  - path: /*
    name: X-Frame-Options
    value: DENY
  - path: /*
    name: X-Content-Type-Options
    value: nosniff
    envVars:
  - key: API_BASE_URL
    value: https://ibc-play-api.onrender.com
    autoDeploy: true

# Database (SQLite in development, PostgreSQL for production)

# For production, uncomment below and add PostgreSQL database

# databases:

# - name: ibc-play-db

# databaseName: ibc_play

# user: ibc_user

# region: oregon

# plan: free

# postgresMajorVersion: 15